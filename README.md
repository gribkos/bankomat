# bankomat
C# bankomat

Программа представляет собой простенький эмулятор банкомата. Является консольным приложением. Данные хранятся во внешней MySQL базе данных. 
Поддерживаемые функции: 
  1. Авторизация по номеру карты и пин-коду; 
  2. Пополнение счёта в рублях;
  3. Снятие со счёта в трёх валютах (рубли, доллары, евро) с учётом курса к рублю;
  4. Создание информации по совершённым операциям (пополнение и снятие); 
  5. Отображение баланса клиента.

Краткое описание функиций: 
  1.1 Проверяется корректность введённого номера карты. При не правильно введённом номере выдаётся ошибка;
  1.2 Проверяется корректность введённого пин-кода и его соответствие номеру карты. Если пин-код введён не правильно, то выдаётся ошибка;
  1.3 Проверяется активен клиент или заблокирован. Если клиент не активен, то выдаётся соответствующее уведомление.

  2.1 Пополнение только в рублях;
  2.2 Проверка кратности вносимых средств на соответствие основным "бумажным" номиналам рубля (10, 100, 500, 1000, 2000, 5000 рублей). Если не соответствует,       то выдаётся соответствующее предупреждение;
  2.3 При успешном пополнении создаётся запись о проведённой операции;

  3.1 Снятие доступно в трёх базовых валютах - рубли, доллары, евро. Клиенту предоставляется выбор валюты снятия;
  3.2 При снятии в валютах != RUB учитывается курс выбранной валюты к рублю. Списание со счёта клиента происходит в рублях после подсчёта в соответствии с         курсом;
  3.3 Проверяется кратность снимаемой валюты на соответствие основным бумажным номиналам:
    3.3.1 Рубли - 10, 100, 500, 1000, 2000, 5000 рублей;
    3.3.2 Доллары - 1 доллар;
    3.3.3 Евро - 5, 10, 20, 50, 100, 200, 500 евро;
  3.4 Проверяется сумма доступного остатка клиента. Если сумма снятия превышает доступный остаток клиента, то выдаётся соответствующее сообщение;
  3.5 Кроме доступного остатка клиента, проверяется доступный остаток средств в самом банкомате. Если сумма предполагаемого снятия превышает доступный             остаток банкомата, то выдаётся соответствующее сообщение;
  3.6 Банкомат имеет записи о базовых валютах и остатком по каждой валюте;
  3.7 При успешном снятии создаётся запись о проведённой операции;

  4.1 Запись о проведённой операции создаётся только для успешных операций;
  4.2 При создании записи указываются: номер операции, дата, номер карты, код операции (1- списание, 2 - пополнение), сумма в валюте, курс, код валюты,             посчитанная в соответствии с курсом сумма в рублях;

  5. Отображение текущего баланса клиента в рублях;
  
  6. Таблицы БД: 
  Таблица, содержащая информацию по клиентам: 
create table client
(id INTEGER NOT NULL AUTO_INCREMENT, 
name VARCHAR(20) NOT NULL, 
s_name VARCHAR(20) NOT NULL, 
otchestvo VARCHAR(20), 
card_number INT NOT NULL, 
pin INT NOT NULL, 
status TINYINT NOT NULL, 
primechanie VARCHAR(200), 
PRIMARY KEY (id));

  Таблица, содержащая информацию по балансу клиента:
create table client_balance 
(id INTEGER NOT NULL AUTO_INCREMENT, 
card_number INT NOT NULL, 
balance FLOAT NOT NULL, 
PRIMARY KEY (id));

  Таблица, содержащая информацию по балансу банкомата: 
create table bankomat_balance 
(currency_code SMALLINT NOT NULL, 
currency VARCHAR(4) NOT NULL, 
summa FLOAT NOT NULL);

  Таблица, содержащая информацию по операциям: 
create table txn 
(txn_id INTEGER NOT NULL AUTO_INCREMENT, 
created_on DATETIME NOT NULL, 
card_number INTEGER, 
operation TINYINT NOT NULL, 
init_amount FLOAT NOT NULL, 
txn_rate FLOAT NOT NULL, 
to_currency_code INTEGER NOT NULL, 
amount_reated FLOAT NOT NULL, 
PRIMARY KEY (txn_id));

  Таблица, содержащая информацию по курсам валют: 
create table rates 
(id INTEGER NOT NULL AUTO_INCREMENT, 
created_on DATETIME NOT NULL, 
from_curr INTEGER, 
to_curr INTEGER, 
rate FLOAT, 
PRIMARY KEY (id));


Баги/недоработки: 
  1. Нет обработки ошибки, позволяющей работать дальше или совершить повторную попытку подключения, если отвалилось соединение с БД;
  2. Нет обработки ошибки, при котором можно продолжить работу, если клиент нажимал Enter вместо ввода номера карты или пин-кода;
  3. При выборе значения "0 - выход" при выборе валюты списания, происходит выход на приглашение ввода карты вместо возврата на уровень выше (выбор                операции);
  4. Добавить нового клиента, сменить пин-код существующего клиента возможно только через БД;
  5. Добавить курсы можно только через БД;
  6. Нет шифрования номера карты и пин-кода в БД. 
